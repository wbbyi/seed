{"version":3,"file":"upload.js","sources":["utils/upload.js"],"sourcesContent":["/**\r\n * 选择图片并上传\r\n * @param {String} src 图片路径\r\n * @returns {Promise} 包含图片临时路径的Promise\r\n */\r\nexport function chooseAndUpload() {\r\n  return new Promise((resolve, reject) => {\r\n    uni.chooseImage({\r\n      count: 1,\r\n      sizeType: ['compressed'],\r\n      sourceType: ['album', 'camera'],\r\n      success: (res) => {\r\n        const tempFilePaths = res.tempFilePaths;\r\n        resolve(tempFilePaths[0]);\r\n      },\r\n      fail: (err) => {\r\n        reject(err);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nexport function cropImage(src) {\r\n  return new Promise((resolve, reject) => {\r\n    uni.chooseImage({\r\n      count: 1,\r\n      sizeType: ['compressed'],\r\n      sourceType: ['album'],\r\n      success: (res) => {\r\n        uni.cropImage({\r\n          src: res.tempFilePaths[0],\r\n          cropScale: '1:1', // 正方形裁剪\r\n          success: (res) => {\r\n            resolve(res.tempFilePath);\r\n          },\r\n          fail: (err) => {\r\n            reject(err);\r\n          }\r\n        });\r\n      },\r\n      fail: (err) => {\r\n        reject(err);\r\n      }\r\n    });\r\n  });\r\n}"],"names":["uni"],"mappings":";;AAKO,SAAS,kBAAkB;AAChC,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,UAAU,CAAC,YAAY;AAAA,MACvB,YAAY,CAAC,SAAS,QAAQ;AAAA,MAC9B,SAAS,CAAC,QAAQ;AAChB,cAAM,gBAAgB,IAAI;AAC1B,gBAAQ,cAAc,CAAC,CAAC;AAAA,MACzB;AAAA,MACD,MAAM,CAAC,QAAQ;AACb,eAAO,GAAG;AAAA,MACX;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;;"}